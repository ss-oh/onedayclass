<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>원데이 클래스 - 레슨 신청</title>
    <link rel="stylesheet" href="./styles.css" />
</head>

<body>
    <header>
        <div class="container header-container">
            <h1><a href="index.html">원데이 클래스</a></h1>
            <button id="menu-btn" aria-label="메뉴 열기">&#9776;</button>
            <nav id="nav-menu" class="hidden">
                <a href="index.html">Home</a>
                <a href="guide.html">이용안내</a>
                <a href="pro.html">프로소개</a>
                <a href="lessons.html">레슨일정</a>
                <a href="apply.html">레슨 신청</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="container">
            <h2>레슨 신청</h2>
            <form id="apply-form">
                <label for="name">이름</label>
                <input type="text" id="name" name="name" required />

                <label for="phone">연락처</label>
                <input type="tel" id="phone" name="phone" pattern="01[016789]-?\\d{3,4}-?\\d{4}"
                    placeholder="010-1234-5678" required />

                <label for="lesson">나이 선택</label>
                <select id="lesson" name="lesson" required>
                    <option value="">선택하세요</option>
                    <option value="30대">(30대)36~39세</option>
                    <option value="40대">(40대)40~49세</option>
                    <option value="50대">(50대)50~59세</option>
                </select>

                <button type="submit">신청하기</button>
            </form>
        </section>
    </main>

    <script>
        const menuBtn = document.getElementById("menu-btn");
        const navMenu = document.getElementById("nav-menu");
        menuBtn.addEventListener("click", () => {
            navMenu.classList.toggle("hidden");
        });

        const form = document.getElementById("apply-form");
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const name = formData.get("name").trim();
            const phone = formData.get("phone").trim();
            const lesson = formData.get("lesson");

            if (!name || !phone || !lesson) {
                alert("모든 항목을 입력해 주세요.");
                return;
            }

            try {
                await fetch("https://onedayclass-sms-server.onrender.com/send-sms", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        Authorization: "hmac-sha256 NCSXTXVEMJC7BTKC:FDC1BAWYZD9A4KCB2EYHU6GWJEEPMW15",
                    },
                    body: JSON.stringify({ name, phone, lesson }),
                });

                alert("신청이 완료되었습니다.");
                form.reset();
            } catch (error) {
                alert("서버 연결 실패: " + error.message);
            }
        });
    </script>
</body>

</html>